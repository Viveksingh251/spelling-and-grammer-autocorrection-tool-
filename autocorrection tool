import tkinter as tk
from tkinter import messagebox
from textblob import TextBlob
from transformers import T5ForConditionalGeneration, T5Tokenizer

# Load model
my_model = "vennify/t5-base-grammar-correction"
tokenizer = T5Tokenizer.from_pretrained(my_model)
model = T5ForConditionalGeneration.from_pretrained(my_model)

def correct_spelling(text):
    blob = TextBlob(text)
    return str(blob.correct())

def correct_grammar(text):
    input_text = "grammar: " + text
    inputs = tokenizer.encode(input_text, return_tensors="pt", truncation=True, max_length=128)
    outputs = model.generate(inputs, max_length=128, num_beams=4, early_stopping=True)
    return tokenizer.decode(outputs[0], skip_special_tokens=True)

def run_autocorrect():
    user_text = input_box.get("1.0", tk.END).strip()
    if not user_text:
        messagebox.showwarning("Warning", "Please enter a sentence.")
        return()
    try:
        spelling = correct_spelling(user_text)
        grammar = correct_grammar(spelling)
        result_box.config(state="normal")
        result_box.delete("1.0", tk.END)
        result_box.insert(tk.END, grammar)
        result_box.config(state="disabled")
    except Exception as e:
        messagebox.showerror("Error", str(e))

# Setup GUI
root = tk.Tk()
root.title("AI Autocorrect Tool")
root.geometry("600x800")
root.resizable(True, True)

# Input
tk.Label(root, text="Enter your sentence:", font=("Arial", 12)).pack(pady=10)
input_box = tk.Text(root, height=10, width=80, font=("Arial", 10))
input_box.pack()

# Button
tk.Button(root, text="Correct Text", command=run_autocorrect, font=("Arial", 12), bg="skyblue").pack(pady=10)

# Output
tk.Label(root, text="Corrected Output:", font=("Arial", 12)).pack(pady=5)
result_box = tk.Text(root, height=10, width=80, font=("Arial", 10), state="disabled", bg="#efe8e8")
result_box.pack()

# Run the app
root.mainloop()
